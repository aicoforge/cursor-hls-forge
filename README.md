[English](./README_EN.md) | **ç¹é«”ä¸­æ–‡**

# Cursor-HLS-Forge

## AI ä»£ç† + çŸ¥è­˜åº«é©…å‹•çš„ HLS/FPGA è‡ªå‹•è¨­è¨ˆé©—è­‰å¹³å°

> è®“ç¡¬é«”é–‹ç™¼åƒè»Ÿé«”ä¸€æ¨£æ•æ· â€” å°‡æ•¸æœˆé–‹ç™¼ç¸®çŸ­è‡³æ•¸å°æ™‚

---

## å°ˆæ¡ˆç°¡ä»‹

**Cursor-HLS-Forge** æ˜¯ AICOFORGE å¹³å°çš„æ ¸å¿ƒæŠ€è¡“ï¼Œå±•ç¤ºå¦‚ä½•é€é AI ä»£ç†ï¼ˆCursor IDEï¼‰çµåˆçµæ§‹åŒ–çŸ¥è­˜åº«ï¼ˆPostgreSQLï¼‰ï¼Œå¯¦ç¾ HLS/FPGA è¨­è¨ˆçš„è‡ªå‹•åŒ–å„ªåŒ–èˆ‡é©—è­‰ã€‚

### æ ¸å¿ƒåƒ¹å€¼

| æŒ‡æ¨™ | æˆæœ |
|:---:|:---:|
| **99.6%** | æ€§èƒ½æå‡ï¼ˆII: 264 â†’ 1 é€±æœŸï¼‰|
| **2 å°æ™‚** | å®Œæˆå‚³çµ±éœ€ 2-3 é€±çš„å·¥ä½œ |
| **300+** | çŸ¥è­˜è¦å‰‡åº«è‡ªå‹•æ‡‰ç”¨ |
| **90%+** | è¨­è¨ˆé‡ç¾æˆåŠŸç‡ï¼ˆå°æ¯”é€šç”¨ AI çš„ 60%ï¼‰ |

---

## FIR æ¿¾æ³¢å™¨å„ªåŒ–å¯¦ä¾‹

æœ¬å°ˆæ¡ˆä»¥ 128-tap FIR æ¿¾æ³¢å™¨ç‚ºä¾‹ï¼Œå±•ç¤º AI å¦‚ä½•é€éçŸ¥è­˜åº«å¼•å°ï¼Œé€æ­¥å°‡è¨­è¨ˆå¾æœªå„ªåŒ–ç‹€æ…‹æå‡è‡³æœ€ä½³æ•ˆèƒ½ã€‚

### å„ªåŒ–è¿­ä»£æ­·ç¨‹

```
Iteration #1   â†’   #2   â†’   #3   â†’   #4   â†’   #5
          II=264   II=134   II=128   II=2     II=1
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â–¶
                    99.6% æ€§èƒ½æå‡
```

| è¿­ä»£ | å„ªåŒ–æ–¹æ³• | II é”æˆ | è³‡æºä½¿ç”¨ | æ‡‰ç”¨è¦å‰‡ |
|:---:|:---|:---:|:---|:---|
| #1 | åŸºæº–è¨­è¨ˆï¼šåˆ†é›¢çš„ shift èˆ‡ MAC è¿´åœˆ | 264 | DSP=1 | â€” |
| #2 | è¿´åœˆåˆä½µï¼šä½¿ç”¨ä¸‰å…ƒé‹ç®—å­æ•´åˆ | 134 | DSP=1 | P001 |
| #3 | Pipeline Rewindï¼šæœ‰é™è¿´åœˆå„ªåŒ– | 128 | DSP=1 | P002 |
| #4 | Array Partition + Unroll | 2 | DSP=2, BRAM=2 | P003, P004 |
| #5 | å®Œæ•´åˆ†å‰² + ä¸²æµ AXIS ä»‹é¢ | **1** | DSP=2, LUT=2306, FF=4772 | P002-P004, R001, R025, R061 |

---

## å±•ç¤ºå½±ç‰‡èˆ‡æ“ä½œæµç¨‹

### Demo 1ï¼šå¾çŸ¥è­˜åº«æŸ¥è©¢æ‰€æœ‰ FIR è¨­è¨ˆè¿­ä»£

**å½±ç‰‡é€£çµ**ï¼š[cursor-hls-demoï¼šlist all fir design iters from KB](https://youtu.be/FWsERNTDri4)

#### æ“ä½œæµç¨‹

**ä½¿ç”¨è€…è¼¸å…¥**ï¼š
> "please list all fir design iterations from current KB including ii/resources/used prompts/inference rules"

**AI ä»£ç†åŸ·è¡Œéç¨‹**ï¼š

1. **ç’°å¢ƒç¢ºèª** â€” AI é¦–å…ˆç¢ºèª Vitis HLS å·¥å…·æ˜¯å¦å¯ç”¨
2. **æŸ¥è©¢çŸ¥è­˜åº«** â€” å‘¼å« KB API å–å¾—æ‰€æœ‰ FIR è¨­è¨ˆç´€éŒ„
3. **ä¿®æ­£éŒ¯èª¤** â€” AI ä¸€é–‹å§‹è¨­å®š `limit=50`ï¼Œä½† API é™åˆ¶æœ€å¤§ç‚º 20ï¼Œè‡ªå‹•ä¿®æ­£å¾Œé‡æ–°æŸ¥è©¢
4. **å–å¾—ç¨‹å¼ç¢¼** â€” é‡å°æ¯å€‹è¿­ä»£ï¼Œé€²ä¸€æ­¥å–å¾—å®Œæ•´ç¨‹å¼ç¢¼èˆ‡è¨»è§£
5. **æ•´ç†å ±å‘Š** â€” ç”¢å‡ºçµæ§‹åŒ–çš„è¿­ä»£æ¸…å–®ï¼ŒåŒ…å«æ•ˆèƒ½æŒ‡æ¨™èˆ‡æ‡‰ç”¨è¦å‰‡

#### AI è‡ªæˆ‘ä¿®æ­£ç¯„ä¾‹

```
ç¬¬ä¸€æ¬¡å˜—è©¦ï¼šcurl "$KB_API/api/design/similar?project_type=fir&limit=50"
API å›æ‡‰ï¼š  {"detail": "Input should be less than or equal to 20"}

è‡ªå‹•ä¿®æ­£ï¼š  curl "$KB_API/api/design/similar?project_type=fir&limit=20"
æˆåŠŸå–å¾—ï¼š  5 ç­† FIR è¨­è¨ˆè¿­ä»£ç´€éŒ„
```

---

### Demo 2ï¼šé‡ç¾çŸ¥è­˜åº«ä¸­çš„ FIR è¨­è¨ˆ Iteration #5

**å½±ç‰‡é€£çµ**ï¼š[cursor-hls-demoï¼šreproduce fir design iter5 from KB](https://youtu.be/5d8HyciMdag)

#### æ“ä½œæµç¨‹

**ä½¿ç”¨è€…è¼¸å…¥**ï¼š
> "please reproduce fir design iteration 5, and verify its csim/csynth results are matched"

**AI ä»£ç†åŸ·è¡Œéç¨‹**ï¼š

1. **å°ˆæ¡ˆæ¢ç´¢** â€” ç¢ºèªæœ¬åœ°å°ˆæ¡ˆçµæ§‹èˆ‡æª”æ¡ˆ
2. **çŸ¥è­˜åº«æŸ¥è©¢** â€” å–å¾— Iteration #5 çš„å®Œæ•´ç¨‹å¼ç¢¼èˆ‡é æœŸæŒ‡æ¨™
3. **ç¨‹å¼ç¢¼éƒ¨ç½²** â€” å°‡ KB ä¸­çš„è¨­è¨ˆç¨‹å¼ç¢¼å¯«å…¥æœ¬åœ°æª”æ¡ˆ
4. **åŸ·è¡Œé©—è­‰** â€” é€é `vitis_hls -f run_hls.tcl` åŸ·è¡Œ C æ¨¡æ“¬èˆ‡åˆæˆ
5. **çµæœæ¯”å°** â€” ç¢ºèªåˆæˆçµæœèˆ‡ KB ç´€éŒ„ä¸€è‡´

#### AI è‡ªæˆ‘ä¿®æ­£ç¯„ä¾‹

**å•é¡Œ**ï¼šç¬¬ä¸€æ¬¡åŸ·è¡Œ C æ¨¡æ“¬æ™‚å‡ºç¾å¤§é‡æ•¸å€¼ä¸åŒ¹é…

```
é¦–æ¬¡åŸ·è¡Œçµæœï¼š
  Mismatch at sample 0: hw=0 sw=-2423
  Mismatch at sample 1: hw=1 sw=-31427
  ...
```

**åŸå› åˆ†æ**ï¼šæ¸¬è©¦å¹³å°ï¼ˆtestbenchï¼‰çš„åƒè€ƒæ¨¡å‹èˆ‡ç¡¬é«”è¨­è¨ˆçš„ä¿‚æ•¸æˆ–è¨ˆç®—é‚è¼¯ä¸ä¸€è‡´

**ä¿®æ­£éç¨‹**ï¼šAI æª¢æŸ¥ä¸¦ä¿®æ­£æ¸¬è©¦å¹³å°çš„è»Ÿé«”åƒè€ƒå‡½æ•¸ï¼Œç¢ºä¿èˆ‡ç¡¬é«”å¯¦ä½œä½¿ç”¨ç›¸åŒçš„ä¿‚æ•¸è¡¨å’Œè¨ˆç®—æ–¹å¼

**æœ€çµ‚çµæœ**ï¼š
```
âœ“ C Simulation: "Test passed with 256 samples."
âœ“ C Synthesis:  II=1, Latency=9, DSP=2, LUT=2306, FF=4772, BRAM=0
                èˆ‡çŸ¥è­˜åº«ç´€éŒ„å®Œå…¨å»åˆ
```

---

### Demo 3ï¼šç„¡ KB æ¶æ§‹æ¨¡æ¿ vs æœ‰ KB æ¶æ§‹æ¨¡æ¿è¨­è¨ˆ Systolic Array

**å½±ç‰‡é€£çµ**ï¼š[cursor-hls-demoï¼šdesign systolic without KB patterns vs with KB patterns](https://youtu.be/ERsgSPnBJZo)

#### æ“ä½œæµç¨‹

**ä½¿ç”¨è€…è¼¸å…¥**ï¼š
> "design an 8x8 systolic array for matrix multiplication. first attempt without query KB architecture patterns, then attempt with KB architecture patterns, compare both results"

**AI ä»£ç†åŸ·è¡Œéç¨‹**ï¼š

1. **ç’°å¢ƒç¢ºèª** â€” ç¢ºèª Vitis HLS å·¥å…·å¯ç”¨
2. **åŸºæº–è¨­è¨ˆ** â€” ä¸æŸ¥è©¢ KBï¼Œç›´æ¥è¨­è¨ˆ 8x8 systolic array
3. **çŸ¥è­˜åº«æŸ¥è©¢** â€” å‘¼å« KB API å–å¾— systolic æ¶æ§‹æ¨¡æ¿èˆ‡å„ªåŒ–è¦å‰‡
4. **å„ªåŒ–è¨­è¨ˆ** â€” æ‡‰ç”¨ KB ä¸­çš„æ¶æ§‹æ¨¡æ¿é€²è¡Œé‡æ–°è¨­è¨ˆ
5. **åˆæˆé©—è­‰** â€” åˆ†åˆ¥åŸ·è¡Œ csim/csynth é©—è­‰å…©ç¨®è¨­è¨ˆ
6. **æ¯”è¼ƒåˆ†æ** â€” ç”¢å‡ºå®Œæ•´æ¯”è¼ƒå ±å‘Š

#### KB æŸ¥è©¢çµæœ

```bash
# æŸ¥è©¢ç›¸ä¼¼è¨­è¨ˆ
curl "http://192.168.1.11:8000/api/design/similar?project_type=matmul&limit=10"

# å–å¾—åƒè€ƒè¨­è¨ˆï¼šSystolic8x8_Wavefront
# æ¶æ§‹ç‰¹å¾µï¼šBoundary injection + single time-loop (t=0..3N-3)
# é—œéµ Pragmasï¼ša_pipe/b_pipe complete partition, PIPELINE II=1, full UNROLL
```

#### å„ªåŒ–æ­·ç¨‹

| è¨­è¨ˆéšæ®µ | II | æå‡å€æ•¸ | æ‡‰ç”¨çš„ KB çŸ¥è­˜ |
|:---|:---:|:---:|:---|
| Baselineï¼ˆç„¡ KBï¼‰ | 588 | â€” | ç„¡ |
| æ‡‰ç”¨ KB è¦å‰‡ï¼ˆç„¡è¼¸å…¥åˆ†å‰²ï¼‰ | 73 | 8x | P003, P004, R035, P099 |
| å®Œæ•´è¼¸å…¥é™£åˆ—åˆ†å‰² | **1** | 73x | + Input Array Partition |
| ä¸²æµä»‹é¢è¨­è¨ˆ | **1** | 73x | + KB åƒè€ƒæ¨¡æ¿ï¼ˆStreamsï¼‰ |

**ç¸½æ•ˆèƒ½æå‡ï¼š588x**ï¼ˆII: 588 â†’ 1ï¼‰

#### é—œéµ KB è¦å‰‡

| è¦å‰‡ä»£ç¢¼ | èªªæ˜ |
|:---:|:---|
| P099 | Input skew logicï¼ˆæœ€å¸¸è¦‹ systolic éŒ¯èª¤ï¼‰ |
| P003 | å®Œæ•´é‡ç–Š load/compute/store |
| P004 | ç„¡è·¨è¿­ä»£ç›¸ä¾æ€§ |
| R035 | Pipeline æœ€å…§å±¤è¿´åœˆ |

#### æœ€çµ‚çµæœ

```
âœ“ Baseline Design:
  II=588, Latency=N/A, DSP=1, LUT=558, FF=123

âœ“ II=1 Partitioned Design:
  II=1, Latency=45 cycles, Pipeline Depth=4, Fmax=271.15 MHz

âœ“ II=1 Stream Design (KB Reference Pattern):
  II=1, Latency=~22 cycles/batch, Pipeline Depth=5, Fmax=144.68 MHz

çµè«–ï¼šKB æ¶æ§‹æ¨¡æ¿å¯¦ç¾ 588x æ•ˆèƒ½æå‡ï¼
```

---

## ç³»çµ±æ¶æ§‹

```mermaid
flowchart TB
    User["ğŸ‘¤ ä½¿ç”¨è€…<br/>è‡ªç„¶èªè¨€è¼¸å…¥"]
    
    subgraph AI["AI ä»£ç†å±¤ (Cursor IDE)"]
        AI1["GPT-4 ç´šèªæ„ç†è§£"]
        AI2["è‡ªå‹•ç”Ÿæˆ HLS ç¨‹å¼ç¢¼"]
        AI3["æ™ºèƒ½éŒ¯èª¤è¨ºæ–·èˆ‡ä¿®æ­£"]
    end
    
    subgraph KB["çŸ¥è­˜åº«å±¤ (PostgreSQL)"]
        KB1["300+ å„ªåŒ–è¦å‰‡"]
        KB2["æ­·å²è¨­è¨ˆç¶“é©—"]
        KB3["æœ€ä½³å¯¦è¸ç´¯ç©"]
    end
    
    subgraph FPGA["FPGA å±¤ (Vitis HLS)"]
        FPGA1["C/C++ â†’ RTL åˆæˆ"]
        FPGA2["æ™‚åºåˆ†æ"]
        FPGA3["è³‡æºè©•ä¼°"]
    end
    
    User --> AI
    AI --> KB
    AI --> FPGA
```

---

## çŸ¥è­˜åº« API ç«¯é»

| ç«¯é» | åŠŸèƒ½ |
|:---|:---|
| `GET /api/design/similar` | æŸ¥è©¢ç›¸ä¼¼è¨­è¨ˆæ¡ˆä¾‹ |
| `GET /api/design/{id}/code` | å–å¾—ç‰¹å®šè¿­ä»£çš„å®Œæ•´ç¨‹å¼ç¢¼ |
| `GET /api/rules/effective` | å–å¾—æœ‰æ•ˆå„ªåŒ–è¦å‰‡ |
| `POST /api/design/complete_iteration` | è¨˜éŒ„æ–°çš„è¨­è¨ˆè¿­ä»£ |

---

## æ•ˆèƒ½æŒ‡æ¨™èªªæ˜

- **II (Initiation Interval)**ï¼šé€£çºŒè³‡æ–™è™•ç†çš„é–“éš”é€±æœŸæ•¸ï¼ŒII=1 è¡¨ç¤ºæ¯é€±æœŸå¯è™•ç†ä¸€ç­†è³‡æ–™
- **Latency**ï¼šå–®ç­†è³‡æ–™å¾è¼¸å…¥åˆ°è¼¸å‡ºçš„ç¸½å»¶é²é€±æœŸ
- **DSP**ï¼šæ•¸ä½è¨Šè™Ÿè™•ç†å–®å…ƒä½¿ç”¨é‡
- **LUT**ï¼šæŸ¥æ‰¾è¡¨é‚è¼¯è³‡æºä½¿ç”¨é‡
- **FF**ï¼šæš«å­˜å™¨ä½¿ç”¨é‡
- **BRAM**ï¼šå€å¡Šè¨˜æ†¶é«”ä½¿ç”¨é‡

---

## å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒéœ€æ±‚

- Xilinx Vitis HLS 2022.1+
- PostgreSQLï¼ˆç”¨æ–¼çŸ¥è­˜åº«ï¼‰
- Cursor IDEï¼ˆAI ä»£ç†ä»‹é¢ï¼‰

### åŸ·è¡Œç¯„ä¾‹

```bash
# é€²å…¥ FIR ç¯„ä¾‹ç›®éŒ„
cd examples/fir128

# åŸ·è¡Œ HLS æµç¨‹ï¼ˆC æ¨¡æ“¬ + åˆæˆï¼‰
vitis_hls -f run_hls.tcl
```

---

## ç›¸é—œé€£çµ

- **AICOFORGE å®˜ç¶²**ï¼š[aicoforge.com](https://aicoforge.com)
- **FPGA ç’°å¢ƒè¨­ç½®å°ˆæ¡ˆ**ï¼š[cursor-fpga-forge](https://github.com/aicoforge/cursor-fpga-forge)
- **Demo å½±ç‰‡æ’­æ”¾æ¸…å–®**ï¼š[YouTube Channel](https://www.youtube.com/@aicoforge)

---

## æˆæ¬Šæ¢æ¬¾

MIT License

---

## é—œæ–¼ AICOFORGE

AICOFORGE æ˜¯ä¸€å€‹ AI ä»£ç† + FPGA è‡ªå‹•è¨­è¨ˆé©—è­‰å¹³å°ï¼Œè‡´åŠ›æ–¼è®“ç¡¬é«”é–‹ç™¼åƒè»Ÿé«”ä¸€æ¨£æ•æ·ã€‚æˆ‘å€‘èˆ‡å°ç£å¤§å­¸é›»æ©Ÿç³»è³´ç‘¾æ•™æˆï¼ˆå‰å¨ç››é›»å­ CTO æš¨å‰µè¾¦äººï¼‰å…±åŒç ”ç™¼ LLM2HLS ç†è«–æŠ€è¡“ï¼Œçµåˆå­¸è¡“å‰µæ–°èˆ‡ç”¢æ¥­å¯¦æˆ°ç¶“é©—ã€‚

---

## ç³»çµ±æ¶æ§‹èˆ‡æŠ€è¡“ä¾†æº

### AICOFORGE å¹³å°

**AICOFORGE** é–‹ç™¼çš„ HLS Knowledge Base System åŒ…å«ï¼š

- çŸ¥è­˜åº«æ¶æ§‹ï¼ˆPostgreSQL + FastAPIï¼‰
- åŸºç¤è¦å‰‡åº«ï¼ˆå®˜æ–¹è¦å‰‡ï¼‰
- AI æ¨ç†æ¡†æ¶ï¼ˆ.cursorrules æ•´åˆï¼‰

### æˆæ¬Šè²æ˜

AICOFORGE å¹³å°æä¾›å­¸è¡“é–‹æºç‰ˆæœ¬ï¼Œèˆ‡æˆ‘å€‘è¯ç¹«å¾Œå¯å–å¾—ç¨‹å¼ç¢¼èˆ‡æ–‡ä»¶ï¼š

**å…è¨±ä½¿ç”¨ç¯„åœ**
- éå•†æ¥­æ€§æ•™å­¸ç ”ç©¶
- å­¸è¡“æˆæœç™¼è¡¨
- é–‹æºå°ˆæ¡ˆè²¢ç»

**é™åˆ¶ä½¿ç”¨ç¯„åœ**
- ç‡Ÿåˆ©æ€§ç”¢å“é–‹ç™¼
- æŠ€è¡“è½‰æˆæ¬Š
- å®Œæ•´ç³»çµ±è¤‡è£½è²©å”®

**æŠ€è¡“ä¾†æº**ï¼š[github.com/aicoforge](https://github.com/aicoforge)  
**å•†æ¥­åˆä½œ**ï¼škevinjan@aicoforge.com
